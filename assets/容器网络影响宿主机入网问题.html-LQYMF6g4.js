import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,f as n,o as e}from"./app-DHtTel8Q.js";const l="/blog/assets/ifconfig-CEwaL59R.png",d={};function p(t,s){return e(),i("div",null,[...s[0]||(s[0]=[n('<h1 id="容器网络影响宿主机入网问题排查" tabindex="-1"><a class="header-anchor" href="#容器网络影响宿主机入网问题排查"><span>容器网络影响宿主机入网问题排查</span></a></h1><h2 id="问题描述" tabindex="-1"><a class="header-anchor" href="#问题描述"><span>问题描述</span></a></h2><p>发现172.27.0.0/16，172.26.0.0/16 网段的服务无法访问宿主机的服务</p><h2 id="问题排查" tabindex="-1"><a class="header-anchor" href="#问题排查"><span>问题排查</span></a></h2><figure><img src="'+l+`" alt="这是图片" tabindex="0" loading="lazy"><figcaption>ifconfig</figcaption></figure><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>docker network ls</span></span>
<span class="line"><span>NETWORK ID     NAME                      DRIVER    SCOPE</span></span>
<span class="line"><span>8eacdcbf22d7   7b-full_default           bridge    local</span></span>
<span class="line"><span>f22af6f77037   bridge                    bridge    local</span></span>
<span class="line"><span>4a56201be716   host                      host      local</span></span>
<span class="line"><span>6e36d25cdbb0   llama2-13b-lora_default   bridge    local</span></span>
<span class="line"><span>fb2839792d18   llama3-8b_lora_default    bridge    local</span></span>
<span class="line"><span>d1f916892b02   none                      null      local</span></span>
<span class="line"><span>2c9c2578ecce   tgi_default               bridge    local</span></span>
<span class="line"><span>446845acbad5   v2-9b_default             bridge    local</span></span>
<span class="line"><span>d1301d605f3c   v2-27b-it_default         bridge    local</span></span>
<span class="line"><span>c3d523d51ee4   v3-8b_default             bridge    local</span></span>
<span class="line"><span>1d3cf7bd9665   v4-9b_default             bridge    local</span></span>
<span class="line"><span>59aecf59ca81   v31-8b_default            bridge    local</span></span>
<span class="line"><span>42cca879c18f   webui-docker_default      bridge    local</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>发现1d3cf7bd9665、1d3cf7bd9665占用了172.27.0.0/16，172.26.0.0/16 网段，导致路由冲突。Linux 内核的路由机制会优先选择 最匹配的路由，它会覆盖默认路由，流量会被错误的流向docker。</p><h2 id="解决方法" tabindex="-1"><a class="header-anchor" href="#解决方法"><span>解决方法</span></a></h2><h3 id="修改docker-配置-不使用冲突网段" tabindex="-1"><a class="header-anchor" href="#修改docker-配置-不使用冲突网段"><span>修改docker 配置，不使用冲突网段</span></a></h3><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;bip&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;192.168.100.1/24&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;default-address-pools&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;base&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;192.168.200.0/20&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;size&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">24</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="创建容器时使用特定网络" tabindex="-1"><a class="header-anchor" href="#创建容器时使用特定网络"><span>创建容器时使用特定网络</span></a></h3><p>docker network create --subnet=xx.xx.xx.xx/24 my_custom_network</p><h3 id="如果必须保留冲突网段-修改宿主机路由-让外部网络优先" tabindex="-1"><a class="header-anchor" href="#如果必须保留冲突网段-修改宿主机路由-让外部网络优先"><span>如果必须保留冲突网段，修改宿主机路由，让外部网络优先</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> route</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> del</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 172.27.0.0/16</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> route</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 172.27.0.0/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> via</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">外部网</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">关&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">metric</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>`,14)])])}const h=a(d,[["render",p]]),o=JSON.parse('{"path":"/zh/%E8%BF%90%E7%BB%B4/docker/%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E5%BD%B1%E5%93%8D%E5%AE%BF%E4%B8%BB%E6%9C%BA%E5%85%A5%E7%BD%91%E9%97%AE%E9%A2%98.html","title":"容器网络影响宿主机入网问题排查","lang":"zh-CN","frontmatter":{"description":"容器网络影响宿主机入网问题排查 问题描述 发现172.27.0.0/16，172.26.0.0/16 网段的服务无法访问宿主机的服务 问题排查 这是图片ifconfig 发现1d3cf7bd9665、1d3cf7bd9665占用了172.27.0.0/16，172.26.0.0/16 网段，导致路由冲突。Linux 内核的路由机制会优先选择 最匹配的路...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"容器网络影响宿主机入网问题排查\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-10-01T01:41:06.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hang\\",\\"url\\":\\"https://mister-hope.com\\"}]}"],["meta",{"property":"og:url","content":"https://mister-hope.github.io/blog/zh/%E8%BF%90%E7%BB%B4/docker/%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E5%BD%B1%E5%93%8D%E5%AE%BF%E4%B8%BB%E6%9C%BA%E5%85%A5%E7%BD%91%E9%97%AE%E9%A2%98.html"}],["meta",{"property":"og:site_name","content":"Blog"}],["meta",{"property":"og:title","content":"容器网络影响宿主机入网问题排查"}],["meta",{"property":"og:description","content":"容器网络影响宿主机入网问题排查 问题描述 发现172.27.0.0/16，172.26.0.0/16 网段的服务无法访问宿主机的服务 问题排查 这是图片ifconfig 发现1d3cf7bd9665、1d3cf7bd9665占用了172.27.0.0/16，172.26.0.0/16 网段，导致路由冲突。Linux 内核的路由机制会优先选择 最匹配的路..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-10-01T01:41:06.000Z"}],["meta",{"property":"article:modified_time","content":"2025-10-01T01:41:06.000Z"}]]},"git":{"createdTime":1759282066000,"updatedTime":1759282866000,"contributors":[{"name":"liuhang","username":"liuhang","email":"git.ushareit.me","commits":2,"url":"https://github.com/liuhang"}]},"readingTime":{"minutes":0.85,"words":256},"filePathRelative":"zh/运维/docker/容器网络影响宿主机入网问题.md","excerpt":"\\n<h2>问题描述</h2>\\n<p>发现172.27.0.0/16，172.26.0.0/16 网段的服务无法访问宿主机的服务</p>\\n<h2>问题排查</h2>\\n<figure><figcaption>ifconfig</figcaption></figure>\\n<div class=\\"language- line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-\\"><span class=\\"line\\"><span>docker network ls</span></span>\\n<span class=\\"line\\"><span>NETWORK ID     NAME                      DRIVER    SCOPE</span></span>\\n<span class=\\"line\\"><span>8eacdcbf22d7   7b-full_default           bridge    local</span></span>\\n<span class=\\"line\\"><span>f22af6f77037   bridge                    bridge    local</span></span>\\n<span class=\\"line\\"><span>4a56201be716   host                      host      local</span></span>\\n<span class=\\"line\\"><span>6e36d25cdbb0   llama2-13b-lora_default   bridge    local</span></span>\\n<span class=\\"line\\"><span>fb2839792d18   llama3-8b_lora_default    bridge    local</span></span>\\n<span class=\\"line\\"><span>d1f916892b02   none                      null      local</span></span>\\n<span class=\\"line\\"><span>2c9c2578ecce   tgi_default               bridge    local</span></span>\\n<span class=\\"line\\"><span>446845acbad5   v2-9b_default             bridge    local</span></span>\\n<span class=\\"line\\"><span>d1301d605f3c   v2-27b-it_default         bridge    local</span></span>\\n<span class=\\"line\\"><span>c3d523d51ee4   v3-8b_default             bridge    local</span></span>\\n<span class=\\"line\\"><span>1d3cf7bd9665   v4-9b_default             bridge    local</span></span>\\n<span class=\\"line\\"><span>59aecf59ca81   v31-8b_default            bridge    local</span></span>\\n<span class=\\"line\\"><span>42cca879c18f   webui-docker_default      bridge    local</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{h as comp,o as data};
